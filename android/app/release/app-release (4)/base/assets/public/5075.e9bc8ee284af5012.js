"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5075,8254],{3008:(y,g,s)=>{s.d(g,{s:()=>d});var l=s(467),i=s(8254),_=s(2615);let d=(()=>{var P;class o{constructor(){this.INSPECAO_INICIAL_KEY="checklist_inspecao_inicial",this.INSPECAO_VEICULO_KEY="checklist_inspecao_veiculo",this.FOTOS_VEICULO_KEY="checklist_fotos_veiculo",this.PNEUS_KEY="checklist_pneus"}salvarInspecaoInicial(n){var a=this;return(0,l.A)(function*(){try{yield i.Preferences.set({key:a.INSPECAO_INICIAL_KEY,value:JSON.stringify(n)}),console.log("Inspe\xe7\xe3o inicial salva localmente")}catch(e){console.error("Erro ao salvar inspe\xe7\xe3o inicial:",e)}})()}recuperarInspecaoInicial(){var n=this;return(0,l.A)(function*(){try{const{value:a}=yield i.Preferences.get({key:n.INSPECAO_INICIAL_KEY});return a?(console.log("Inspe\xe7\xe3o inicial recuperada"),JSON.parse(a)):null}catch(a){return console.error("Erro ao recuperar inspe\xe7\xe3o inicial:",a),null}})()}salvarInspecaoVeiculo(n){var a=this;return(0,l.A)(function*(){try{yield i.Preferences.set({key:a.INSPECAO_VEICULO_KEY,value:JSON.stringify(n)}),console.log("Inspe\xe7\xe3o do ve\xedculo salva localmente")}catch(e){console.error("Erro ao salvar inspe\xe7\xe3o do ve\xedculo:",e)}})()}recuperarInspecaoVeiculo(){var n=this;return(0,l.A)(function*(){try{const{value:a}=yield i.Preferences.get({key:n.INSPECAO_VEICULO_KEY});return a?(console.log("Inspe\xe7\xe3o do ve\xedculo recuperada"),JSON.parse(a)):null}catch(a){return console.error("Erro ao recuperar inspe\xe7\xe3o do ve\xedculo:",a),null}})()}salvarFotosVeiculo(n){var a=this;return(0,l.A)(function*(){try{yield i.Preferences.set({key:a.FOTOS_VEICULO_KEY,value:JSON.stringify(n)}),console.log("Fotos do ve\xedculo salvas localmente")}catch(e){console.error("Erro ao salvar fotos do ve\xedculo:",e)}})()}recuperarFotosVeiculo(){var n=this;return(0,l.A)(function*(){try{const{value:a}=yield i.Preferences.get({key:n.FOTOS_VEICULO_KEY});return a?(console.log("Fotos do ve\xedculo recuperadas"),JSON.parse(a)):null}catch(a){return console.error("Erro ao recuperar fotos do ve\xedculo:",a),null}})()}salvarPneus(n){var a=this;return(0,l.A)(function*(){try{yield i.Preferences.set({key:a.PNEUS_KEY,value:JSON.stringify(n)}),console.log("Pneus salvos localmente")}catch(e){console.error("Erro ao salvar pneus:",e)}})()}recuperarPneus(){var n=this;return(0,l.A)(function*(){try{const{value:a}=yield i.Preferences.get({key:n.PNEUS_KEY});return a?(console.log("Pneus recuperados"),JSON.parse(a)):null}catch(a){return console.error("Erro ao recuperar pneus:",a),null}})()}limparTodosDados(){var n=this;return(0,l.A)(function*(){try{yield i.Preferences.remove({key:n.INSPECAO_INICIAL_KEY}),yield i.Preferences.remove({key:n.INSPECAO_VEICULO_KEY}),yield i.Preferences.remove({key:n.FOTOS_VEICULO_KEY}),yield i.Preferences.remove({key:n.PNEUS_KEY}),console.log("Todos os dados locais foram limpos")}catch(a){console.error("Erro ao limpar dados locais:",a)}})()}temDadosSalvos(){var n=this;return(0,l.A)(function*(){try{return null!==(yield n.recuperarInspecaoInicial())}catch{return!1}})()}static#o=P=()=>(this.\u0275fac=function(a){return new(a||o)},this.\u0275prov=_.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}))}return P(),o})()},5075:(y,g,s)=>{s.r(g),s.d(g,{HomePageModule:()=>f});var l=s(2200),i=s(7343),_=s(4341),d=s(8132),P=s(467),o=s(3664),C=s(4192),n=s(9041),a=s(6386),e=s(3008);let r=(()=>{var h;class u{constructor(p,t,v,O,F){this.router=p,this.checklistData=t,this.apiService=v,this.localStorage=O,this.alertController=F}ngOnInit(){var p=this;return(0,P.A)(function*(){yield p.verificarDadosPendentes()})()}verificarDadosPendentes(){var p=this;return(0,P.A)(function*(){var O;(yield p.localStorage.temDadosSalvos())&&(yield(yield p.alertController.create({header:"Dados Salvos Encontrados",message:"Encontramos dados de um checklist n\xe3o finalizado. Deseja continuar de onde parou?",buttons:[{text:"Come\xe7ar Novo",role:"cancel",handler:(O=(0,P.A)(function*(){yield p.localStorage.limparTodosDados(),console.log("Dados antigos limpos")}),function(){return O.apply(this,arguments)})},{text:"Continuar",handler:()=>{p.iniciarChecklist()}}]})).present())})()}iniciarChecklist(){this.router.navigate(["/inspecao-inicial"])}voltar(){this.router.navigate(["/admin"])}static#o=h=()=>(this.\u0275fac=function(t){return new(t||u)(o.rXU(C.Ix),o.rXU(n.I),o.rXU(a.G),o.rXU(e.s),o.rXU(i.hG))},this.\u0275cmp=o.VBU({type:u,selectors:[["app-home"]],standalone:!1,decls:51,vars:2,consts:[[3,"translucent"],["color","dark"],["color","dark",3,"fullscreen"],["collapse","condense"],["size","large"],[1,"home-container"],[1,"welcome-section"],["src","assets/img/logo.png","alt","i9 Checklist",1,"logo-img"],[1,"info-card"],[1,"checklist-info"],[1,"info-item"],["name","clipboard-outline","color","primary"],["name","construct-outline","color","primary"],["name","camera-outline","color","primary"],["name","ellipse-outline","color","primary"],[1,"action-section"],["expand","block","size","large","color","primary",1,"start-button",3,"click"],["slot","start","name","play-circle"]],template:function(t,v){1&t&&(o.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),o.EFF(3," Checklist Veicular "),o.k0s()()(),o.j41(4,"ion-content",2)(5,"ion-header",3)(6,"ion-toolbar",1)(7,"ion-title",4),o.EFF(8,"Checklist Veicular"),o.k0s()()(),o.j41(9,"div",5)(10,"div",6),o.nrm(11,"img",7),o.j41(12,"h1"),o.EFF(13,"Bem-vindo ao i9 Checklist"),o.k0s(),o.j41(14,"p"),o.EFF(15,"Sistema de inspe\xe7\xe3o veicular completo"),o.k0s()(),o.j41(16,"ion-card",8)(17,"ion-card-content")(18,"div",9)(19,"div",10),o.nrm(20,"ion-icon",11),o.j41(21,"div")(22,"h3"),o.EFF(23,"Inspe\xe7\xe3o Inicial"),o.k0s(),o.j41(24,"p"),o.EFF(25,"Placa, KM, Combust\xedvel e Painel"),o.k0s()()(),o.j41(26,"div",10),o.nrm(27,"ion-icon",12),o.j41(28,"div")(29,"h3"),o.EFF(30,"Inspe\xe7\xe3o do Ve\xedculo"),o.k0s(),o.j41(31,"p"),o.EFF(32,"Motor, El\xe9tricos, Limpeza e Ferramentas"),o.k0s()()(),o.j41(33,"div",10),o.nrm(34,"ion-icon",13),o.j41(35,"div")(36,"h3"),o.EFF(37,"Fotos do Ve\xedculo"),o.k0s(),o.j41(38,"p"),o.EFF(39,"Registro fotogr\xe1fico completo"),o.k0s()()(),o.j41(40,"div",10),o.nrm(41,"ion-icon",14),o.j41(42,"div")(43,"h3"),o.EFF(44,"Inspe\xe7\xe3o de Pneus"),o.k0s(),o.j41(45,"p"),o.EFF(46,"Estado dos pneus e estepe"),o.k0s()()()()()(),o.j41(47,"div",15)(48,"ion-button",16),o.bIt("click",function(){return v.iniciarChecklist()}),o.nrm(49,"ion-icon",17),o.EFF(50," Iniciar Checklist "),o.k0s()()()()),2&t&&(o.Y8G("translucent",!0),o.R7$(4),o.Y8G("fullscreen",!0))},dependencies:[i.Jm,i.b_,i.I9,i.W9,i.eU,i.iq,i.BC,i.ai],styles:[".home-container[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;min-height:100%}.welcome-section[_ngcontent-%COMP%]{text-align:center;padding:40px 20px 30px}.welcome-section[_ngcontent-%COMP%]   .logo-img[_ngcontent-%COMP%]{width:100px;height:100px;margin-bottom:20px;object-fit:contain}.welcome-section[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:80px;margin-bottom:20px}.welcome-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--ion-color-light);font-size:28px;font-weight:700;margin:0 0 10px}.welcome-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:16px;margin:0}.info-card[_ngcontent-%COMP%]{background:var(--ion-color-step-50);box-shadow:0 2px 12px #0000004d;margin-bottom:20px}.checklist-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.info-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:15px}.info-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;flex-shrink:0;margin-top:4px}.info-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1}.info-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;color:var(--ion-color-light);font-size:16px;font-weight:600}.info-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--ion-color-medium);font-size:13px}.action-section[_ngcontent-%COMP%]{margin-top:auto;padding:20px 0 40px}.action-section[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]{--box-shadow: 0 4px 16px rgba(66, 140, 255, .4);font-weight:700;font-size:18px;height:56px}"]}))}return h(),u})();var c=s(2615);const m=[{path:"",component:r}];let E=(()=>{var h;class u{static#o=h=()=>(this.\u0275fac=function(t){return new(t||u)},this.\u0275mod=o.$C({type:u}),this.\u0275inj=c.G2t({imports:[d.iI.forChild(m),d.iI]}))}return h(),u})(),f=(()=>{var h;class u{static#o=h=()=>(this.\u0275fac=function(t){return new(t||u)},this.\u0275mod=o.$C({type:u}),this.\u0275inj=c.G2t({imports:[l.MD,_.YN,i.bv,E]}))}return h(),u})()},5312:(y,g,s)=>{s.d(g,{c:()=>l});const l={production:!0,apiUrl:"https://floripa.in9automacao.com.br"}},6386:(y,g,s)=>{s.d(g,{G:()=>o});var l=s(467),i=s(9330),_=s(5312),d=s(2615);let P=(()=>{var C;class n{constructor(){}compressPhoto(e){var r=this;return(0,l.A)(function*(c,m=1200,E=.8){return new Promise((f,h)=>{try{c.split(",");const I=new Image;I.onload=()=>{try{let{width:p,height:t}=r.calculateDimensions(I.width,I.height,m);const v=document.createElement("canvas"),O=v.getContext("2d");if(!O)return void h(new Error("N\xe3o foi poss\xedvel criar contexto do canvas"));v.width=p,v.height=t,O.drawImage(I,0,0,p,t);const F=v.toDataURL("image/jpeg",E);console.log(`Foto comprimida: ${c.length} -> ${F.length} caracteres`),f(F)}catch(p){h(p)}},I.onerror=()=>{h(new Error("Erro ao carregar a imagem"))},I.src=c}catch(u){h(u)}})}).apply(this,arguments)}calculateDimensions(e,r,c){return e<=c?{width:e,height:r}:{width:c,height:Math.round(r*(c/e))}}compressAllPhotos(e){var r=this;return(0,l.A)(function*(){const c={...e},m=["fotoKmInicial","fotoCombustivel","fotoPainel","motorAguaRadiadorFoto","motorAguaParabrisaFoto","motorFluidoFreioFoto","motorNivelOleoFoto","motorTampaReservatorioFoto","motorTampaRadiadorFoto","limpezaInternaFoto","limpezaExternaFoto","fotoFrontal","fotoTraseira","fotoLateralDireita","fotoLateralEsquerda","pneuDianteiraDireitaFoto","pneuDianteiraEsquerdaFoto","pneuTraseiraDireitaFoto","pneuTraseiraEsquerdaFoto","pneuEstepeFoto"];for(const E of m)if(c[E]&&"string"==typeof c[E])try{c[E]=yield r.compressPhoto(c[E])}catch(f){console.warn(`Erro ao comprimir foto ${E}:`,f)}return c})()}static#o=C=()=>(this.\u0275fac=function(r){return new(r||n)},this.\u0275prov=d.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}))}return C(),n})(),o=(()=>{var C;class n{constructor(e,r){this.http=e,this.photoCompression=r,this.baseUrl=_.c.apiUrl}testarConexao(){return this.http.get(`${this.baseUrl}/b_veicular_get.php?acao=todos&limite=1`)}testarConexaoSimples(){return this.http.get(`${this.baseUrl}/test_connection.php`)}salvarChecklist(e){const r=new i.Lr({"Content-Type":"application/json"});return console.log("=== SALVANDO CHECKLIST ==="),console.log("URL:",`${this.baseUrl}/b_veicular_set.php`),console.log("Headers:",r),console.log("Dados:",e),console.log("Tamanho dos dados:",JSON.stringify(e).length,"bytes"),this.http.post(`${this.baseUrl}/b_veicular_set.php`,e,{headers:r})}criarInspecaoInicial(e){const r=new i.Lr({"Content-Type":"application/json"});return console.log("=== CRIANDO INSPE\xc7\xc3O INICIAL ==="),console.log("URL:",`${this.baseUrl}/b_veicular_set.php`),console.log("Dados:",e),this.http.post(`${this.baseUrl}/b_veicular_set.php`,e,{headers:r})}atualizarInspecao(e,r){const c=new i.Lr({"Content-Type":"application/json"}),m={inspecao_id:e,...r};return console.log("=== ATUALIZANDO INSPE\xc7\xc3O ==="),console.log("URL:",`${this.baseUrl}/b_veicular_update.php`),console.log("Dados:",m),this.http.post(`${this.baseUrl}/b_veicular_update.php`,m,{headers:c})}salvarChecklistSimples(e){var r=this;return(0,l.A)(function*(){console.log("=== COMPRIMINDO FOTOS ===");const c=yield r.photoCompression.compressAllPhotos(e),m=r.transformarParaApiFormat(c);return console.log("Fotos comprimidas com sucesso"),r.salvarChecklist(m)})()}buscarTodos(e=100){return this.http.get(`${this.baseUrl}/b_veicular_get.php?acao=todos&limite=${e}`)}buscarPorPlaca(e){return this.http.get(`${this.baseUrl}/b_veicular_get.php?acao=placa&placa=${e}`)}buscarPorId(e){return this.http.get(`${this.baseUrl}/b_veicular_get.php?acao=id&id=${e}`)}buscarCompleto(e){return this.http.get(`${this.baseUrl}/b_veicular_get.php?acao=completo&id=${e}`)}buscarPorPeriodo(e,r){return this.http.get(`${this.baseUrl}/b_veicular_get.php?acao=periodo&data_inicio=${e}&data_fim=${r}`)}salvarChecklistCompleto(e){const r=new i.Lr({"Content-Type":"application/json"});return console.log("=== SALVANDO CHECKLIST COMPLETO ==="),console.log("URL:",`${this.baseUrl}/b_checklist_completo_set.php`),console.log("Dados:",e),this.http.post(`${this.baseUrl}/b_checklist_completo_set.php`,e,{headers:r})}buscarChecklistCompleto(e){return this.http.get(`${this.baseUrl}/b_checklist_completo_get.php?acao=id&id=${e}`)}buscarChecklistsCompletos(e=100){return this.http.get(`${this.baseUrl}/b_checklist_completo_get.php?acao=todos&limite=${e}`)}buscarChecklistCompletosPorPlaca(e){return this.http.get(`${this.baseUrl}/b_checklist_completo_get.php?acao=placa&placa=${e}`)}buscarChecklistCompletosPorPeriodo(e,r){return this.http.get(`${this.baseUrl}/b_checklist_completo_get.php?acao=periodo&data_inicio=${e}&data_fim=${r}`)}transformarParaApiFormat(e){const r=e.inspecaoInicial,c=e.inspecaoVeiculo,m=e.fotosVeiculo||[],E=e.pneus||[];console.log("=== TRANSFORMANDO DADOS DINAMICAMENTE ==="),console.log("Checklist completo:",e);const f=[];(c?.motor||[]).forEach(t=>{f.push({categoria:"MOTOR",item:t.nome,status:t.valor,foto:t.foto||null})}),(c?.eletricos||[]).forEach(t=>{f.push({categoria:"ELETRICO",item:t.nome,status:t.valor,foto:t.foto||null})}),(c?.limpeza||[]).forEach(t=>{f.push({categoria:"LIMPEZA",item:t.nome,status:t.valor,foto:t.foto||null})}),(c?.ferramentas||[]).forEach(t=>{f.push({categoria:"FERRAMENTA",item:t.nome,status:t.valor,foto:t.foto||null})});const h=[];E.forEach(t=>{h.push({item:t.nome,status:t.valor,foto:t.foto||null,pressao:t.pressao||null,foto_caneta:t.fotoCaneta||null})});const u={},I={"Foto Frontal":"foto_frontal","Foto Traseira":"foto_traseira","Foto Lateral Direita":"foto_lateral_direita","Foto Lateral Esquerda":"foto_lateral_esquerda"};m.forEach(t=>{const v=I[t.tipo];v&&(u[v]=t.foto||"")}),console.log("Total de itens de inspe\xe7\xe3o:",f.length),console.log("Total de pneus:",h.length),console.log("Fotos mapeadas:",Object.keys(u));const p={placa:r?.placa||"",km_inicial:r?.kmInicial||0,nivel_combustivel:r?.nivelCombustivel||"0%",foto_painel:r?.fotoPainel||"",observacao_painel:r?.observacaoPainel||"",usuario_id:e.usuario_id||null,itens_inspecao:f,itens_pneus:h,...u};return console.log("=== DADOS FINAIS DIN\xc2MICOS PARA ENVIO ==="),console.log("Itens de inspe\xe7\xe3o:",p.itens_inspecao.length),console.log("Itens de pneus:",p.itens_pneus.length),console.log("Dados completos:",p),p}static#o=C=()=>(this.\u0275fac=function(r){return new(r||n)(d.KVO(i.Qq),d.KVO(P))},this.\u0275prov=d.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}))}return C(),n})()},8254:(y,g,s)=>{s.r(g),s.d(g,{Preferences:()=>i});const i=(0,s(5083).F3)("Preferences",{web:()=>s.e(2924).then(s.bind(s,2924)).then(_=>new _.PreferencesWeb)})},9041:(y,g,s)=>{s.d(g,{I:()=>i});var l=s(2615);let i=(()=>{var _;class d{constructor(){this.checklistData={}}setInspecaoInicial(o){this.checklistData.inspecaoInicial=o}setInspecaoVeiculo(o){this.checklistData.inspecaoVeiculo=o}setFotosVeiculo(o){this.checklistData.fotosVeiculo=o}setPneus(o){this.checklistData.pneus=o,this.checklistData.dataRealizacao=new Date}getChecklistCompleto(){return this.checklistData}limparChecklist(){this.checklistData={}}setInspecaoId(o){this.checklistData.inspecao_id=o}getInspecaoId(){return this.checklistData.inspecao_id}static#o=_=()=>(this.\u0275fac=function(C){return new(C||d)},this.\u0275prov=l.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}))}return _(),d})()}}]);