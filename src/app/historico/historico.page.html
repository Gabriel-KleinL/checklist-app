<ion-header [translucent]="true">
  <ion-toolbar color="dark">
    <ion-buttons slot="start">
      <ion-button (click)="voltar()">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Histórico de Checklists</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" color="dark">
  <ion-header collapse="condense">
    <ion-toolbar color="dark">
      <ion-title size="large">Histórico</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Pull to Refresh -->
  <ion-refresher slot="fixed" (ionRefresh)="recarregar($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="content-container">
    <!-- Barra de Busca -->
    <ion-searchbar
      placeholder="Buscar por placa"
      (ionInput)="buscarPorPlaca($event)"
      debounce="500"
    ></ion-searchbar>

    <!-- Loading -->
    <div *ngIf="carregando" class="loading-container">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Carregando checklists...</p>
    </div>

    <!-- Erro -->
    <ion-card *ngIf="erro && !carregando" color="danger">
      <ion-card-content>
        <ion-icon name="alert-circle"></ion-icon>
        {{ erro }}
      </ion-card-content>
    </ion-card>

    <!-- Lista vazia -->
    <div *ngIf="!carregando && !erro && checklists.length === 0" class="empty-state">
      <ion-icon name="document-text-outline"></ion-icon>
      <h3>Nenhum checklist encontrado</h3>
      <p>Os checklists realizados aparecerão aqui.</p>
    </div>

    <!-- Lista de Checklists -->
    <ion-list *ngIf="!carregando && checklists.length > 0">
      <ion-item-sliding *ngFor="let checklist of checklists">
        <ion-item button (click)="verDetalhes(checklist)">
          <ion-icon name="car" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h2><strong>{{ checklist.placa }}</strong></h2>
            <p>KM: {{ checklist.km_inicial }} | Combustível: {{ checklist.nivel_combustivel }}</p>
            <p class="data-texto">{{ formatarData(checklist.data_realizacao) }}</p>
          </ion-label>
          <ion-icon name="chevron-forward" slot="end"></ion-icon>
        </ion-item>

        <ion-item-options side="end">
          <ion-item-option color="primary" (click)="verDetalhes(checklist)">
            <ion-icon slot="icon-only" name="eye"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>
  </div>
</ion-content>
